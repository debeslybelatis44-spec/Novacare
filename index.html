<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Système de Gestion Hospitalier</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div id="login-screen" class="login-container">
        <div class="login-box">
            <div class="text-center mb-3">
                <img id="login-logo" src="" alt="Logo" class="certificate-logo" style="display:none;">
                <i class="fas fa-hospital-alt fa-3x" style="color: #1a6bca;" id="login-icon"></i>
                <h2 style="color: #1a6bca;" id="hospital-name-login">Hôpital Saint-Luc</h2>
            </div>
            
            <div class="login-buttons">
                <div class="login-role-btn active" data-role="admin"><i class="fas fa-user-shield"></i><p>Admin</p></div>
                <div class="login-role-btn" data-role="secretary"><i class="fas fa-user-tie"></i><p>Secrétariat</p></div>
                <div class="login-role-btn" data-role="cashier"><i class="fas fa-cash-register"></i><p>Caisse</p></div>
                <div class="login-role-btn" data-role="nurse"><i class="fas fa-user-nurse"></i><p>Infirmier</p></div>
                <div class="login-role-btn" data-role="doctor"><i class="fas fa-user-md"></i><p>Médecin</p></div>
                <div class="login-role-btn" data-role="lab"><i class="fas fa-flask"></i><p>Laboratoire</p></div>
                <div class="login-role-btn" data-role="pharmacy"><i class="fas fa-pills"></i><p>Pharmacie</p></div>
                <div class="login-role-btn" data-role="responsible"><i class="fas fa-user-cog"></i><p>Responsable</p></div>
            </div>
            
            <form id="login-form">
                <div class="form-group">
                    <label class="form-label">Nom d'utilisateur</label>
                    <input type="text" id="username" class="form-control" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Mot de passe</label>
                    <input type="password" id="password" class="form-control" required>
                </div>
                <button type="submit" class="btn" style="width: 100%;">Se Connecter</button>
            </form>
            
            <div class="mt-3 text-center">
                <p><strong>Identifiants par défaut:</strong></p>
                <p><small>Admin: admin / 1234</small></p>
                <p><small>Responsable: responsible / 1234</small></p>
                <p><small>Secrétariat: secretary / 1234</small></p>
                <p><small>Caisse: cashier / 1234</small></p>
                <p><small>Infirmier: nurse / 1234</small></p>
                <p><small>Médecin: doctor / 1234</small></p>
                <p><small>Laboratoire: lab / 1234</small></p>
                <p><small>Pharmacie: pharmacy / 1234</small></p>
            </div>
        </div>
    </div>
    
    <div id="main-app" class="hidden">
        <div class="container">
            <header class="header">
                <div class="logo">
                    <img id="header-logo" src="" alt="Logo" class="logo-img" style="display:none;">
                    <i class="fas fa-hospital-alt" id="header-icon"></i>
                    <div><h1 id="hospital-name-header">Hôpital Saint-Luc</h1><p id="hospital-address-header">Système de Gestion</p></div>
                </div>
                <div class="user-info">
                    <div>
                        <p id="current-user-role">Administrateur</p>
                        <p><strong id="current-username">User</strong></p>
                    </div>
                    <button id="logout-btn" class="logout-btn"><i class="fas fa-sign-out-alt"></i> Déconnexion</button>
                </div>
            </header>
            
            <nav class="nav-tabs no-print">
                <div class="nav-tab active" data-target="dashboard"><i class="fas fa-tachometer-alt"></i> Accueil</div>
                <div class="nav-tab" data-target="secretary"><i class="fas fa-user-tie"></i> Secrétariat</div>
                <div class="nav-tab" data-target="cashier"><i class="fas fa-cash-register"></i> Caisse</div>
                <div class="nav-tab" data-target="nurse"><i class="fas fa-user-nurse"></i> Infirmier</div>
                <div class="nav-tab" data-target="doctor"><i class="fas fa-user-md"></i> Médecin</div>
                <div class="nav-tab" data-target="laboratory"><i class="fas fa-flask"></i> Laboratoire</div>
                <div class="nav-tab" data-target="pharmacy"><i class="fas fa-pills"></i> Pharmacie</div>
                <div class="nav-tab nav-tab-with-badge" data-target="messaging"><i class="fas fa-comments"></i> Messagerie <span id="message-badge" class="notification-badge hidden">0</span></div>
                <div class="nav-tab" data-target="administration"><i class="fas fa-chart-bar"></i> Administration</div>
                <div class="nav-tab" data-target="settings"><i class="fas fa-cog"></i> Paramètres</div>
            </nav>
            
            <section id="dashboard" class="content active">
                <h2 class="section-title">Tableau de Bord - <span id="dashboard-role">Administrateur</span></h2>
                <div id="role-dashboard-content"></div>
            </section>
            
            <section id="secretary" class="content">
                <h2 class="section-title">Secrétariat</h2>
                
                <div class="card">
                    <h3><i class="fas fa-user-plus"></i> Nouveau Patient</h3>
                    <form id="patient-registration-form">
                        <div class="d-flex" style="gap:20px; margin-bottom: 15px;">
                            <div style="flex:2">
                                <label class="form-label">Nom complet *</label>
                                <input type="text" id="patient-fullname" class="form-control" required>
                            </div>
                            <div style="flex:1">
                                <label class="form-label">Date de naissance *</label>
                                <input type="date" id="patient-birthdate" class="form-control" required>
                            </div>
                        </div>
                        
                        <div class="d-flex" style="gap:20px; margin-bottom: 15px;">
                            <div style="flex:1">
                                <label class="form-label">Adresse</label>
                                <input type="text" id="patient-address" class="form-control">
                            </div>
                            <div style="flex:1">
                                <label class="form-label">Téléphone *</label>
                                <input type="tel" id="patient-phone" class="form-control" required>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <label class="form-label">Personne responsable (si mineur)</label>
                            <input type="text" id="patient-responsible" class="form-control">
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <label class="form-label">Allergies connues</label>
                            <textarea id="patient-allergies" class="form-control" rows="2" placeholder="Allergies du patient (optionnel)"></textarea>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <label class="form-label">Antécédents médicaux / Notes</label>
                            <textarea id="patient-notes" class="form-control" rows="2" placeholder="Antécédents ou notes importantes (optionnel)"></textarea>
                        </div>
                        
                        <div class="d-flex" style="gap:20px; margin-bottom: 20px;">
                            <div style="flex:1">
                                <label class="form-label">Type de patient</label>
                                <div>
                                    <label><input type="radio" name="patient-type" id="patient-normal" value="normal" checked> Normal</label>
                                    <label style="margin-left: 20px;"><input type="radio" name="patient-type" id="patient-emergency" value="urgence"> Urgence</label>
                                    <label style="margin-left: 20px;"><input type="radio" name="patient-type" id="patient-pediatric" value="pediatrie"> Enfant</label>
                                    <label style="margin-left: 20px;"><input type="radio" name="patient-type" id="patient-external" value="externe"> Externe</label>
                                </div>
                                <div class="mt-2">
                                    <label><input type="checkbox" id="external-only" name="external-only"> Service externe uniquement (pas de consultation)</label>
                                </div>
                            </div>
                            <div style="flex:1" id="consultation-type-container">
                                <label class="form-label">Type de consultation *</label>
                                <select id="consultation-type-secretary" class="form-control" required>
                                    <option value="">Sélectionner...</option>
                                </select>
                                <button type="button" id="modify-consultation-type-btn" class="btn btn-warning btn-sm mt-2 modify-consultation-btn hidden">
                                    <i class="fas fa-edit"></i> Modifier ce type
                                </button>
                            </div>
                        </div>
                        
                        <div id="external-services-selection" class="hidden">
                            <h4>Services externes souhaités</h4>
                            <div id="external-services-options"></div>
                            <button type="button" id="add-external-service-registration" class="btn btn-secondary btn-sm mt-2">
                                <i class="fas fa-plus"></i> Ajouter service
                            </button>
                        </div>
                        
                        <div id="consultation-modification-secretary" class="type-modification-panel hidden">
                            <h4><i class="fas fa-edit"></i> Modification du type de consultation</h4>
                            <div class="d-flex" style="gap:15px;">
                                <input type="text" id="modified-consultation-name" class="form-control" placeholder="Nom modifié">
                                <input type="number" id="modified-consultation-price" class="form-control" placeholder="Prix modifié (Gdes)" min="0">
                                <button type="button" id="save-modified-consultation" class="btn btn-success">Enregistrer</button>
                                <button type="button" id="cancel-consultation-modification" class="btn btn-secondary">Annuler</button>
                            </div>
                            <small class="text-muted">Cette modification s'applique uniquement au patient en cours</small>
                        </div>
                        
                        <div class="d-flex" style="gap:15px;">
                            <button type="submit" class="btn btn-success">
                                <i class="fas fa-save"></i> Enregistrer le dossier
                            </button>
                            <button type="button" id="generate-patient-id-card" class="btn btn-secondary">
                                <i class="fas fa-id-card"></i> Générer la carte patient
                            </button>
                            <button type="button" id="generate-medical-certificate" class="btn btn-info">
                                <i class="fas fa-file-medical"></i> Certificat médical
                            </button>
                        </div>
                    </form>
                </div>
                
                <div class="card">
                    <h3><i class="fas fa-calendar-alt"></i> Gestion des Rendez-vous</h3>
                    <div class="d-flex" style="gap:15px; margin-bottom: 15px;">
                        <input type="text" id="appointment-patient-search" class="form-control" placeholder="ID patient">
                        <button id="search-appointment-patient" class="btn"><i class="fas fa-search"></i> Rechercher</button>
                    </div>
                    
                    <div id="appointment-patient-details" class="hidden">
                        <h4>Patient: <span id="appointment-patient-name"></span></h4>
                        <div class="form-group">
                            <label class="form-label">Date du rendez-vous</label>
                            <input type="date" id="appointment-date" class="form-control">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Heure du rendez-vous</label>
                            <input type="time" id="appointment-time" class="form-control">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Motif</label>
                            <input type="text" id="appointment-reason" class="form-control" placeholder="Motif du rendez-vous">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Médecin</label>
                            <select id="appointment-doctor" class="form-control">
                                <option value="">Sélectionner un médecin</option>
                            </select>
                        </div>
                        <button id="schedule-appointment" class="btn btn-success">
                            <i class="fas fa-calendar-plus"></i> Programmer le rendez-vous
                        </button>
                    </div>
                    
                    <div class="mt-3">
                        <h4>Rendez-vous programmés</h4>
                        <div id="appointments-list"></div>
                    </div>
                </div>
                
                <div class="card">
                    <h3><i class="fas fa-file-invoice-dollar"></i> Facturation Services Externes</h3>
                    <div class="d-flex" style="gap:15px; margin-bottom: 15px;">
                        <input type="text" id="external-service-search" class="form-control" placeholder="ID patient ou nom">
                        <button id="search-external-patient" class="btn"><i class="fas fa-search"></i> Rechercher</button>
                    </div>
                    
                    <div id="external-services-container" class="hidden">
                        <h4>Services externes pour <span id="external-patient-name"></span></h4>
                        <div id="external-services-list"></div>
                        
                        <div class="mt-3">
                            <h5>Ajouter un service externe</h5>
                            <div class="d-flex" style="gap:10px;">
                                <select id="external-service-select" class="form-control">
                                    <option value="">Choisir un service</option>
                                </select>
                                <input type="number" id="new-external-service-price" class="form-control" placeholder="Prix (Gdes)" min="0">
                                <button id="add-external-service" class="btn btn-success">
                                    <i class="fas fa-plus"></i> Ajouter
                                </button>
                            </div>
                        </div>
                        
                        <div class="mt-3">
                            <button id="generate-external-invoice" class="btn btn-warning">
                                <i class="fas fa-file-invoice"></i> Générer facture
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <h3><i class="fas fa-list"></i> Patients enregistrés aujourd'hui</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Nom</th>
                                    <th>Téléphone</th>
                                    <th>Type</th>
                                    <th>Consultation</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="today-patients-list"></tbody>
                        </table>
                    </div>
                </div>
                
                <div id="patient-card-container" class="hidden printable">
                    <div class="patient-card">
                        <div class="patient-card-header text-center">
                            <img id="card-logo" src="" alt="Logo" style="max-width: 80px; margin: 0 auto 10px; display: none;">
                            <h3 id="card-hospital-name">Hôpital Saint-Luc</h3>
                            <p id="card-hospital-address">Port-au-Prince, Haïti</p>
                        </div>
                        <div class="patient-photo">
                            <i class="fas fa-user fa-3x" style="color:#666;"></i>
                        </div>
                        <div class="text-center">
                            <h4 id="card-patient-name">Jean Dupont</h4>
                            <p><strong>ID:</strong> <span id="card-patient-id">PA0001</span></p>
                            <p><strong>Date Naissance:</strong> <span id="card-patient-dob">01/01/1980</span></p>
                            <p><strong>Téléphone:</strong> <span id="card-patient-phone">12345678</span></p>
                            <p><strong>Date d'émission:</strong> <span id="card-issue-date">01/01/2024</span></p>
                            <div class="mt-3">
                                <span id="card-patient-type" class="emergency-patient-tag">URGENCE</span>
                            </div>
                        </div>
                        <div class="text-center mt-3">
                            <p><small>Cette carte doit être présentée à chaque visite</small></p>
                            <p><small>Valable pour 1 an à partir de la date d'émission</small></p>
                        </div>
                    </div>
                </div>
                
                <div id="medical-certificate-container" class="hidden printable">
                    <div class="medical-certificate">
                        <div class="certificate-header">
                            <img id="certificate-logo" src="" alt="Logo" class="certificate-logo" style="display:none;">
                            <h2 id="certificate-hospital-name">Hôpital Saint-Luc</h2>
                            <p id="certificate-hospital-address">Port-au-Prince, Haïti</p>
                            <p id="certificate-hospital-phone">Tél: (509) 1234-5678</p>
                            <h3 style="margin-top: 20px;">CERTIFICAT MÉDICAL</h3>
                        </div>
                        
                        <div class="certificate-body">
                            <p style="text-align: right;">N°: <span id="certificate-number">CM-001</span></p>
                            <p>Le directeur de l'établissement <strong id="certificate-hospital-name-text">Hôpital Saint-Luc</strong>,</p>
                            <p style="text-align: center; margin: 30px 0; font-size: 1.2em;">
                                <strong>CERTIFIE</strong>
                            </p>
                            <p>Que <strong id="certificate-patient-name">Jean Dupont</strong>, né(e) le <span id="certificate-patient-dob">01/01/1980</span>,</p>
                            <p>demeurant à <span id="certificate-patient-address">123 Rue Principale, Port-au-Prince</span>,</p>
                            <p>a été examiné(e) dans notre établissement le <span id="certificate-consultation-date">01/01/2024</span>.</p>
                            
                            <div style="margin: 30px 0;">
                                <p><strong>Diagnostic:</strong></p>
                                <div id="certificate-diagnosis" style="padding: 15px; background: #f8f9fa; border-radius: 5px; margin-top: 10px;">
                                    Fièvre légère et maux de tête. Pas de signes alarmants.
                                </div>
                            </div>
                            
                            <p>En conséquence, nous attestons que l'intéressé(e) est dans l'incapacité de poursuivre ses activités habituelles et nécessite:</p>
                            
                            <div style="margin: 20px 0;">
                                <div id="certificate-rest-type">
                                    <p><input type="radio" name="rest-type" value="indetermine" checked> Un repos d'une durée indéterminée</p>
                                    <p><input type="radio" name="rest-type" value="determine"> Un repos de <input type="number" id="rest-days" value="7" style="width: 60px;"> jours</p>
                                </div>
                            </div>
                            
                            <p>Le présent certificat est délivré à la demande de l'intéressé(e) pour faire valoir ce que de droit.</p>
                        </div>
                        
                        <div class="certificate-footer">
                            <div style="text-align: right;">
                                <p>Fait à Port-au-Prince, le <span id="certificate-date">01 janvier 2024</span></p>
                                <div class="signature-area">
                                    <p>Le Médecin Responsable,</p>
                                    <p style="margin-top: 50px;">___________________________</p>
                                    <p>Dr. <span id="certificate-doctor">Médecin</span></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="cashier" class="content">
                <h2 class="section-title">Caisse</h2>
                
                <div class="card">
                    <h3><i class="fas fa-exchange-alt"></i> Taux de Change</h3>
                    <div class="d-flex" style="gap:15px; align-items: center; margin-bottom: 15px;">
                        <label for="exchange-rate">1 $ =</label>
                        <input type="number" id="exchange-rate" class="form-control" style="width:100px;" value="130" min="1">
                        <label>Gdes</label>
                        <button id="update-exchange-rate" class="btn btn-secondary">Mettre à jour</button>
                    </div>
                </div>
                
                <div class="card">
                    <h3><i class="fas fa-search"></i> Rechercher Patient</h3>
                    <div class="d-flex" style="gap:15px;">
                        <input type="text" id="cashier-patient-search" class="form-control" placeholder="ID patient ou nom" autofocus>
                        <button id="search-cashier-patient" class="btn"><i class="fas fa-search"></i> Rechercher</button>
                    </div>
                </div>
                
                <div id="cashier-patient-details" class="hidden">
                    <div class="card">
                        <h3>Détails du patient: <span id="cashier-patient-name"></span> (<span id="cashier-patient-id"></span>)</h3>
                        
                        <div class="mt-3">
                            <h4>Services à payer</h4>
                            <div id="services-to-pay-list"></div>
                            
                            <div class="cashier-total">
                                <h3>Total à payer: <span id="total-to-pay">0</span> Gdes (<span id="total-to-pay-usd">0.00</span> $)</h3>
                            </div>
                        </div>
                        
                        <div class="mt-3">
                            <h4>Devise de paiement</h4>
                            <div class="payment-method-currency-selector">
                                <div class="payment-method-currency active" data-currency="HTG">
                                    <i class="fas fa-money-bill-wave"></i>
                                    <p>Gourdes (HTG)</p>
                                </div>
                                <div class="payment-method-currency" data-currency="USD">
                                    <i class="fas fa-dollar-sign"></i>
                                    <p>Dollars (USD)</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-3">
                            <h4>Moyen de paiement</h4>
                            <div class="payment-method-selector">
                                <div class="payment-method active" data-method="cash">
                                    <i class="fas fa-money-bill-wave fa-2x"></i>
                                    <p>Espèces</p>
                                </div>
                                <div class="payment-method" data-method="moncash">
                                    <i class="fas fa-mobile-alt fa-2x"></i>
                                    <p>MonCash</p>
                                </div>
                                <div class="payment-method" data-method="natcash">
                                    <i class="fas fa-wallet fa-2x"></i>
                                    <p>NatCash</p>
                                </div>
                                <div class="payment-method" data-method="card">
                                    <i class="fas fa-credit-card fa-2x"></i>
                                    <p>Carte bancaire</p>
                                </div>
                                <div class="payment-method" data-method="external">
                                    <i class="fas fa-external-link-alt fa-2x"></i>
                                    <p>Paiement externe</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="change-money-container">
                            <h4>Calcul de monnaie</h4>
                            <div class="d-flex" style="gap:15px; align-items: center;">
                                <label>Montant donné:</label>
                                <input type="number" id="amount-given" class="form-control" style="width:150px;" placeholder="Montant en Gdes" min="0">
                                <div class="change-money-result" id="change-result">Monnaie: 0 Gdes</div>
                            </div>
                        </div>
                        
                        <div class="d-flex justify-between mt-3">
                            <button id="mark-as-paid" class="btn btn-success">
                                <i class="fas fa-check-circle"></i> Marquer comme payé
                            </button>
                            <button id="print-invoice" class="btn btn-warning">
                                <i class="fas fa-print"></i> Imprimer la facture
                            </button>
                            <button id="print-receipt" class="btn btn-info">
                                <i class="fas fa-receipt"></i> Imprimer reçu
                            </button>
                            <button id="print-general-sheet" class="btn btn-primary">
                                <i class="fas fa-file-alt"></i> Fiche générale
                            </button>
                        </div>
                    </div>
                    
                    <div id="invoice-container" class="hidden printable">
                        <div class="print-receipt">
                            <div class="text-center">
                                <img id="invoice-logo" src="" alt="Logo" style="max-width: 80px; margin: 0 auto 10px; display: none;">
                                <h3 id="invoice-hospital-name">Hôpital Saint-Luc</h3>
                                <p id="invoice-hospital-address">Port-au-Prince, Haïti</p>
                                <p id="invoice-hospital-phone">Tél: (509) 1234-5678</p>
                                <p id="invoice-exchange-rate" style="font-size: 0.9rem; color: #666;">Taux: 1 $ = 130 Gdes</p>
                            </div>
                            <hr>
                            <div>
                                <p><strong>Patient:</strong> <span id="invoice-patient-name">Jean Dupont</span></p>
                                <p><strong>ID Patient:</strong> <span id="invoice-patient-id">PA0001</span></p>
                                <p><strong>Date:</strong> <span id="invoice-date">01/01/2024</span></p>
                                <p><strong>Heure:</strong> <span id="invoice-time">10:30</span></p>
                            </div>
                            <hr>
                            <div id="invoice-services-list"></div>
                            <hr>
                            <div class="receipt-item">
                                <span><strong>TOTAL:</strong></span>
                                <span><strong id="invoice-total-amount">0</strong> Gdes</span>
                            </div>
                            <div class="receipt-item">
                                <span>Montant donné:</span>
                                <span id="invoice-amount-given">0 Gdes</span>
                            </div>
                            <div class="receipt-item">
                                <span>Monnaie rendue:</span>
                                <span id="invoice-change">0 Gdes</span>
                            </div>
                            <div class="receipt-item">
                                <span>Moyen de paiement:</span>
                                <span id="invoice-payment-method">Espèces</span></span>
                            </div>
                            <hr>
                            <div class="text-center">
                                <p>Merci pour votre confiance!</p>
                                <p><small>Facture #<span id="invoice-number">INV001</span></small></p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="external-medications-container" class="hidden card mt-3">
                    <h3><i class="fas fa-exclamation-triangle"></i> Médicaments à acheter ailleurs</h3>
                    <div id="external-medications-list"></div>
                    <div class="print-controls">
                        <button id="print-external-meds" class="btn btn-warning">
                            <i class="fas fa-print"></i> Imprimer la liste
                        </button>
                    </div>
                </div>
            </section>
            
            <section id="nurse" class="content">
                <h2 class="section-title">Infirmier - Signes Vitaux</h2>
                
                <div class="card">
                    <h3><i class="fas fa-search"></i> Rechercher Patient</h3>
                    <div class="d-flex" style="gap:15px;">
                        <input type="text" id="nurse-patient-search" class="form-control" placeholder="ID patient ou nom">
                        <button id="search-nurse-patient" class="btn"><i class="fas fa-search"></i> Rechercher</button>
                    </div>
                </div>
                
                <div id="nurse-patient-details" class="hidden">
                    <div class="card">
                        <h3>Patient: <span id="nurse-patient-name"></span> (<span id="nurse-patient-id"></span>)</h3>
                        <p><strong>Statut paiement:</strong> <span id="nurse-payment-status" class="patient-status-badge status-unpaid">Non payé</span></p>
                        
                        <div class="vitals-form mt-3">
                            <h4><i class="fas fa-heartbeat"></i> Signes Vitaux</h4>
                            <form id="vitals-form">
                                <div id="vitals-inputs-container"></div>
                                <button type="submit" class="btn btn-success mt-3">
                                    <i class="fas fa-save"></i> Enregistrer les signes vitaux
                                </button>
                            </form>
                        </div>
                        
                        <div class="mt-3">
                            <h4>Historique des signes vitaux</h4>
                            <div id="vitals-history"></div>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="doctor" class="content">
                <h2 class="section-title">Médecin - Consultation</h2>
                
                <div class="card">
                    <h3><i class="fas fa-search"></i> Rechercher Patient</h3>
                    <div class="d-flex" style="gap:15px;">
                        <input type="text" id="doctor-patient-search" class="form-control" placeholder="ID patient ou nom">
                        <button id="search-doctor-patient" class="btn"><i class="fas fa-search"></i> Rechercher</button>
                    </div>
                </div>
                
                <div id="doctor-patient-details" class="hidden">
                    <div class="card">
                        <h3>Patient: <span id="doctor-patient-name"></span> (<span id="doctor-patient-id"></span>)</h3>
                        
                        <div class="d-flex" style="gap:20px; margin-bottom: 20px;">
                            <div style="flex:1">
                                <p><strong>Âge:</strong> <span id="doctor-patient-age"></span> ans</p>
                                <p><strong>Téléphone:</strong> <span id="doctor-patient-phone"></span></p>
                                <p><strong>Allergies:</strong> <span id="doctor-patient-allergies">Aucune connue</span></p>
                            </div>
                            <div style="flex:1">
                                <p><strong>Type:</strong> <span id="doctor-patient-type"></span></p>
                                <p><strong>Statut paiement:</strong> <span id="doctor-payment-status" class="patient-status-badge"></span></p>
                                <p><strong>Hospitalisé:</strong> <span id="doctor-hospitalized-status">Non</span></p>
                                <p><strong>Notes:</strong> <span id="doctor-patient-notes">Aucune</span></p>
                            </div>
                        </div>
                        
                        <div id="current-consultation-display" class="consultation-display">
                            <h4><i class="fas fa-stethoscope"></i> Consultation enregistrée par le secrétariat</h4>
                            <div id="current-consultation-info"></div>
                            <div id="consultation-modification-section" class="hidden mt-3">
                                <h5>Modifier la consultation</h5>
                                <div class="d-flex" style="gap:10px;">
                                    <select id="doctor-consultation-type" class="form-control">
                                        <option value="">Sélectionner un type</option>
                                    </select>
                                    <button id="update-consultation-type" class="btn btn-warning">Modifier</button>
                                </div>
                                <small class="text-muted">Si le nouveau type est plus cher, le patient devra retourner à la caisse</small>
                            </div>
                        </div>
                        
                        <div id="doctor-patient-vitals" class="vitals-form">
                            <h4><i class="fas fa-heartbeat"></i> Signes Vitaux Récents</h4>
                            <div id="current-vitals-display"></div>
                            <button id="edit-vitals-btn" class="btn btn-warning mt-2">
                                <i class="fas fa-edit"></i> Modifier les signes vitaux
                            </button>
                        </div>
                        
                        <div class="doctor-modification-form hidden" id="doctor-vitals-modification">
                            <h4><i class="fas fa-edit"></i> Modification des signes vitaux</h4>
                            <form id="vitals-modification-form">
                                <div id="vitals-modification-inputs"></div>
                                <button type="submit" class="btn btn-success mt-2">
                                    <i class="fas fa-save"></i> Enregistrer modifications
                                </button>
                                <button type="button" id="cancel-vitals-modification" class="btn btn-secondary mt-2">
                                    Annuler
                                </button>
                            </form>
                        </div>
                        
                        <div class="mt-3">
                            <h4><i class="fas fa-stethoscope"></i> Consultation médicale</h4>
                            <form id="consultation-form">
                                <div class="form-group">
                                    <label class="form-label">Diagnostic *</label>
                                    <textarea id="consultation-diagnosis" class="form-control" rows="3" placeholder="Entrez le diagnostic..." required></textarea>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Notes additionnelles</label>
                                    <textarea id="consultation-notes" class="form-control" rows="2" placeholder="Notes complémentaires..."></textarea>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Analyses demandées 
                                        <button type="button" id="modify-analyses-btn" class="btn btn-warning btn-sm modify-analysis-btn">
                                            <i class="fas fa-edit"></i> Modifier les analyses
                                        </button>
                                    </label>
                                    <div id="lab-analyses-selection"></div>
                                    <div id="lab-modification-panel" class="type-modification-panel hidden">
                                        <h5>Modification des analyses</h5>
                                        <div class="d-flex" style="gap:10px; margin-bottom:10px;">
                                            <input type="text" id="modified-analysis-name" class="form-control" placeholder="Nom modifié">
                                            <input type="number" id="modified-analysis-price" class="form-control" placeholder="Prix modifié (Gdes)" min="0">
                                            <button type="button" id="save-modified-analysis" class="btn btn-success btn-sm">Enregistrer</button>
                                            <button type="button" id="cancel-analysis-modification" class="btn btn-secondary btn-sm">Annuler</button>
                                        </div>
                                        <small class="text-muted">Cette modification s'applique uniquement au patient en cours</small>
                                    </div>
                                    <div class="mt-2">
                                        <input type="text" id="custom-analysis-name" class="form-control" placeholder="Nom d'analyse personnalisée" style="width:70%; display:inline-block;">
                                        <input type="number" id="custom-analysis-price" class="form-control" placeholder="Prix" style="width:25%; display:inline-block;">
                                        <button type="button" id="add-custom-analysis" class="btn btn-sm btn-secondary mt-1">Ajouter analyse personnalisée</button>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Médicaments prescrits</label>
                                    <div class="mb-2">
                                        <input type="text" id="medication-search" class="form-control" placeholder="Rechercher médicament (ex: paracétamol)">
                                        <div id="medication-suggestions" class="hidden" style="border:1px solid #ddd; background:white; max-height:200px; overflow-y:auto; position:absolute; width:300px; z-index:100;"></div>
                                    </div>
                                    
                                    <table class="medication-prescription-table">
                                        <thead>
                                            <tr>
                                                <th>Médicament</th>
                                                <th>Posologie</th>
                                                <th>Quantité</th>
                                                <th>Stock</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody id="prescription-medications-list"></tbody>
                                    </table>
                                    
                                    <div id="stock-warnings" class="mt-2"></div>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Rendez-vous de suivi</label>
                                    <div class="d-flex" style="gap:15px;">
                                        <input type="date" id="followup-date" class="form-control">
                                        <input type="time" id="followup-time" class="form-control">
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">
                                        <input type="checkbox" id="hospitalize-patient"> Hospitaliser le patient
                                    </label>
                                    <small class="text-muted">Si coché, les services seront comptabilisés mais facturés en fin d'hospitalisation.</small>
                                </div>
                                
                                <div class="d-flex" style="gap:15px;">
                                    <button type="submit" class="btn btn-success">
                                        <i class="fas fa-save"></i> Enregistrer la consultation
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                
                <div class="card mt-3">
                    <h3><i class="fas fa-flask"></i> Résultats d'analyses</h3>
                    <div id="doctor-lab-results"></div>
                </div>
                
                <div class="card mt-3">
                    <h3><i class="fas fa-calendar-alt"></i> Rendez-vous des Patients</h3>
                    <div class="d-flex" style="gap:15px; margin-bottom: 15px;">
                        <input type="text" id="doctor-appointment-search-medical" class="form-control" placeholder="ID patient">
                        <button id="search-doctor-appointment-medical" class="btn"><i class="fas fa-search"></i> Rechercher</button>
                    </div>
                    <div id="doctor-appointment-results-medical"></div>
                </div>
            </section>
            
            <section id="laboratory" class="content">
                <h2 class="section-title">Laboratoire</h2>
                
                <div class="card">
                    <h3><i class="fas fa-search"></i> Rechercher Patient</h3>
                    <div class="d-flex" style="gap:15px;">
                        <input type="text" id="lab-patient-search" class="form-control" placeholder="ID patient ou nom">
                        <button id="search-lab-patient" class="btn"><i class="fas fa-search"></i> Rechercher</button>
                    </div>
                </div>
                
                <div id="lab-patient-details" class="hidden">
                    <div class="card">
                        <h3>Patient: <span id="lab-patient-name"></span> (<span id="lab-patient-id"></span>)</h3>
                        <p><strong>Statut paiement:</strong> <span id="lab-payment-status" class="patient-status-badge"></span></p>
                        
                        <div id="lab-analyses-list" class="mt-3"></div>
                    </div>
                </div>
                
                <div class="card mt-3">
                    <h3><i class="fas fa-clock"></i> Analyses en attente de résultats</h3>
                    <div id="pending-analyses-list"></div>
                </div>
            </section>
            
            <section id="pharmacy" class="content">
                <h2 class="section-title">Pharmacie</h2>
                
                <div class="card">
                    <h3><i class="fas fa-search"></i> Rechercher Patient</h3>
                    <div class="d-flex" style="gap:15px;">
                        <input type="text" id="pharmacy-patient-search" class="form-control" placeholder="ID patient ou nom">
                        <button id="search-pharmacy-patient" class="btn"><i class="fas fa-search"></i> Rechercher</button>
                    </div>
                </div>
                
                <div id="pharmacy-patient-details" class="hidden">
                    <div class="card">
                        <h3>Patient: <span id="pharmacy-patient-name"></span> (<span id="pharmacy-patient-id"></span>)</h3>
                        <p><strong>Statut paiement:</strong> <span id="pharmacy-payment-status" class="patient-status-badge"></span></p>
                        
                        <div id="pharmacy-prescriptions-list" class="mt-3"></div>
                        
                        <div class="mt-3">
                            <button id="deliver-medications" class="btn btn-success" disabled>
                                <i class="fas fa-check"></i> Délivrer les médicaments
                            </button>
                            <button id="print-delivery-ticket" class="btn btn-warning">
                                <i class="fas fa-print"></i> Imprimer ticket de délivrance
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="card mt-3 pharmacy-fix">
                    <h3><i class="fas fa-boxes"></i> Gestion du Stock</h3>
                    
                    <div class="d-flex" style="gap:15px; margin-bottom: 15px;">
                        <input type="text" id="medication-search-stock" class="form-control" placeholder="Rechercher médicament (nom, générique, département)">
                        <button id="search-medication" class="btn btn-secondary">Rechercher</button>
                        <button id="add-new-medication" class="btn btn-success">
                            <i class="fas fa-plus"></i> Nouveau médicament
                        </button>
                    </div>
                    
                    <div id="new-medication-form" class="employee-form" style="display: none;">
                        <h4>Ajouter un nouveau médicament</h4>
                        <div class="d-flex" style="gap:10px; margin-bottom: 10px;">
                            <input type="text" id="new-med-name" class="form-control" placeholder="Nom commercial">
                            <input type="text" id="new-med-generic" class="form-control" placeholder="Nom générique">
                        </div>
                        <div class="d-flex" style="gap:10px; margin-bottom: 10px;">
                            <select id="new-med-form" class="form-control">
                                <option value="">Forme</option>
                                <option value="comprimé">Comprimé</option>
                                <option value="capsule">Capsule</option>
                                <option value="sirop">Sirop</option>
                                <option value="injection">Injection</option>
                                <option value="pommade">Pommade</option>
                            </select>
                            <input type="text" id="new-med-unit" class="form-control" placeholder="Unité (comprimés, ml, etc.)">
                            <input type="number" id="new-med-quantity" class="form-control" placeholder="Quantité initiale" min="0">
                        </div>
                        <div class="d-flex" style="gap:10px; margin-bottom: 10px;">
                            <input type="number" id="new-med-alert" class="form-control" placeholder="Seuil d'alerte" min="0">
                            <input type="number" id="new-med-price" class="form-control" placeholder="Prix unitaire (Gdes)" min="0" step="0.01">
                            <input type="date" id="new-med-expiration" class="form-control" placeholder="Date d'expiration">
                        </div>
                        <div class="d-flex" style="gap:10px; margin-bottom: 10px;">
                            <select id="new-med-supplier" class="form-control">
                                <option value="">Fournisseur</option>
                            </select>
                            <select id="new-med-purchase-type" class="form-control">
                                <option value="cash">Achat comptant</option>
                                <option value="credit">Achat à crédit</option>
                            </select>
                        </div>
                        <div class="d-flex" style="gap:10px; margin-bottom: 10px;">
                            <select id="new-med-location" class="form-control">
                                <option value="">Sélectionner un emplacement</option>
                            </select>
                            <select id="new-med-department" class="form-control">
                                <option value="">Sélectionner un département</option>
                            </select>
                        </div>
                        <div class="d-flex" style="gap:10px;">
                            <button type="button" id="save-new-medication" class="btn btn-success">Enregistrer</button>
                            <button type="button" id="cancel-new-medication" class="btn btn-secondary">Annuler</button>
                        </div>
                    </div>
                    
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Médicament</th>
                                    <th>Forme</th>
                                    <th>Département</th>
                                    <th>Quantité</th>
                                    <th>Seuil alerte</th>
                                    <th>Prix unitaire</th>
                                    <th>Expiration</th>
                                    <th>Fournisseur</th>
                                    <th>Emplacement</th>
                                    <th>Statut</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="medication-stock-list"></tbody>
                        </table>
                    </div>
                    
                    <div class="mt-3">
                        <h4><i class="fas fa-exclamation-triangle"></i> Médicaments en rupture/stock faible</h4>
                        <div id="low-stock-medications"></div>
                    </div>
                    
                    <div class="mt-3">
                        <h4><i class="fas fa-calendar-times"></i> Médicaments bientôt expirés ou expirés</h4>
                        <div id="expiring-medications"></div>
                    </div>
                </div>
                
                <!-- Nouveau : Vente directe de médicaments -->
                <div class="card mt-3">
                    <h3><i class="fas fa-cart-plus"></i> Vente directe (sans prescription)</h3>
                    <div class="d-flex" style="gap:10px; margin-bottom:10px;">
                        <input type="text" id="direct-sale-med-name" class="form-control" placeholder="Rechercher médicament">
                        <input type="number" id="direct-sale-quantity" class="form-control" placeholder="Quantité" min="1">
                        <button id="add-direct-sale" class="btn btn-primary">Ajouter à la vente</button>
                    </div>
                    <div id="direct-sale-items"></div>
                    <div class="mt-2">
                        <p>Total: <span id="direct-sale-total">0</span> Gdes</p>
                        <button id="confirm-direct-sale" class="btn btn-success">Générer facture et notifier caisse</button>
                    </div>
                </div>
            </section>
            
            <section id="messaging" class="content">
                <h2 class="section-title"><i class="fas fa-comments"></i> Messagerie</h2>
                
                <div class="messaging-container">
                    <div class="conversation-list">
                        <div class="d-flex" style="gap:10px; margin-bottom: 15px;">
                            <select id="message-recipient" class="form-control">
                                <option value="">Nouveau message...</option>
                                <option value="all">Tous les utilisateurs</option>
                                <option value="all-doctors">Tous les médecins</option>
                                <option value="all-nurses">Tous les infirmiers</option>
                                <option value="all-secretaries">Tous les secrétaires</option>
                                <option value="all-cashiers">Tous les caissiers</option>
                                <option value="all-labs">Tout le laboratoire</option>
                                <option value="all-pharmacies">Toute la pharmacie</option>
                                <option value="all-admins">Tous les administrateurs</option>
                                <option value="all-responsibles">Tous les responsables</option>
                            </select>
                            <button type="button" id="new-conversation-btn" class="btn btn-success">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                        <div id="conversations-container"></div>
                    </div>
                    
                    <div class="chat-container">
                        <div class="card">
                            <h4 id="current-conversation-title">Sélectionnez une conversation</h4>
                            <div class="chat-messages" id="chat-messages"></div>
                            <div class="chat-input-container hidden" id="chat-input-container">
                                <input type="text" id="message-input" class="form-control" placeholder="Tapez votre message...">
                                <button type="button" id="send-message-btn" class="btn btn-success">
                                    <i class="fas fa-paper-plane"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="administration" class="content">
                <h2 class="section-title">Administration - Statistiques</h2>
                
                <div class="admin-search-section card">
                    <h3><i class="fas fa-search"></i> Recherche Patient</h3>
                    <div class="d-flex" style="gap:15px;">
                        <input type="text" id="admin-patient-search" class="form-control" placeholder="ID patient">
                        <button type="button" id="search-admin-patient" class="btn"><i class="fas fa-search"></i> Rechercher</button>
                    </div>
                    <div id="admin-patient-details" class="hidden mt-3">
                        <h4>Patient: <span id="admin-patient-name"></span></h4>
                        
                        <div id="patient-notes-section" class="mt-3">
                            <h5>Notes du patient</h5>
                            <div class="card">
                                <div class="form-group">
                                    <label>Allergies:</label>
                                    <textarea id="patient-allergies-admin" class="form-control" rows="2"></textarea>
                                </div>
                                <div class="form-group">
                                    <label>Antécédents / Notes:</label>
                                    <textarea id="patient-notes-admin" class="form-control" rows="3"></textarea>
                                </div>
                                <button class="btn btn-success" onclick="savePatientNotes()">
                                    <i class="fas fa-save"></i> Enregistrer les notes
                                </button>
                            </div>
                        </div>
                        
                        <div class="privilege-container mt-3">
                            <h5>Gestion des privilèges</h5>
                            <div class="d-flex" style="gap:15px; align-items:center;">
                                <label>Type de privilège:</label>
                                <select id="privilege-type" class="form-control" style="width:200px;">
                                    <option value="none">Aucun privilège</option>
                                    <option value="vip">VIP (gratuit)</option>
                                    <option value="sponsored">Sponsorisé (réduction %)</option>
                                    <option value="credit">Crédit</option>
                                </select>
                                <div id="discount-section" class="hidden">
                                    <label>Pourcentage de réduction:</label>
                                    <input type="number" id="discount-percentage" class="form-control" placeholder="%" min="0" max="100" style="width:100px;">
                                </div>
                                <div id="credit-section" class="hidden">
                                    <label>Montant crédit (Gdes):</label>
                                    <input type="number" id="credit-amount-input" class="form-control" placeholder="Montant" min="0" style="width:150px;">
                                </div>
                                <button type="button" id="save-privilege" class="btn btn-success">Enregistrer</button>
                            </div>
                        </div>
                        
                        <div id="patient-credit-display" class="mt-3"></div>
                        
                        <h4 class="mt-3">Historique complet du patient</h4>
                        <div id="admin-patient-history"></div>
                    </div>
                </div>
                
                <div class="card">
                    <h3><i class="fas fa-credit-card"></i> Gestion des Crédits Patients</h3>
                    <div class="d-flex" style="gap:15px; margin-bottom:15px;">
                        <input type="text" id="credit-patient-id" class="form-control" placeholder="ID patient">
                        <input type="number" id="credit-amount" class="form-control" placeholder="Montant (Gdes)" min="0">
                        <input type="text" id="credit-note" class="form-control" placeholder="Note (optionnel)">
                        <button id="add-credit-btn" class="btn btn-success">Ajouter Crédit</button>
                    </div>
                    <div class="d-flex" style="gap:15px;">
                        <button id="view-credit-history" class="btn btn-info">Voir Historique Crédits</button>
                        <button onclick="usePatientCreditPrompt()" class="btn btn-warning">Utiliser Crédit</button>
                    </div>
                </div>
                
                <div class="card">
                    <h3><i class="fas fa-cash-register"></i> Gestion des Caisses</h3>
                    <div class="d-flex" style="gap:20px; margin-bottom:15px;">
                        <div class="caisse-info">
                            <h5>Caisse Principale (tous modes)</h5>
                            <h2 id="main-cash-balance">0 Gdes</h2>
                            <p>Solde total</p>
                        </div>
                        <div class="caisse-info">
                            <h5>Petite Caisse</h5>
                            <h2 id="petty-cash-balance">0 Gdes</h2>
                            <p>Solde disponible</p>
                        </div>
                    </div>
                    <div class="d-flex" style="gap:10px; flex-wrap:wrap;">
                        <div class="caisse-info" style="min-width:120px;">
                            <h5>Espèces</h5>
                            <h3 id="cash-balance">0</h3>
                        </div>
                        <div class="caisse-info" style="min-width:120px;">
                            <h5>MonCash</h5>
                            <h3 id="moncash-balance">0</h3>
                        </div>
                        <div class="caisse-info" style="min-width:120px;">
                            <h5>NatCash</h5>
                            <h3 id="natcash-balance">0</h3>
                        </div>
                        <div class="caisse-info" style="min-width:120px;">
                            <h5>Carte</h5>
                            <h3 id="card-balance">0</h3>
                        </div>
                        <div class="caisse-info" style="min-width:120px;">
                            <h5>Externe</h5>
                            <h3 id="external-balance">0</h3>
                        </div>
                    </div>
                    <div class="d-flex" style="gap:15px;">
                        <input type="number" id="petty-cash-amount" class="form-control" placeholder="Montant à transférer" min="0">
                        <button id="transfer-petty-cash" class="btn btn-warning">Transférer vers Petite Caisse</button>
                        <button id="view-cashier-balances" class="btn btn-info">Voir Soldes Caissiers</button>
                        <button id="adjust-cashier-balance" class="btn btn-secondary">Ajuster Solde</button>
                    </div>
                </div>
                
                <div class="card">
                    <h3><i class="fas fa-edit"></i> Gestion des Transactions</h3>
                    <div class="d-flex" style="gap:15px; margin-bottom:15px;">
                        <input type="text" id="selected-transaction-id" class="form-control" placeholder="ID Transaction">
                        <button id="edit-transaction-btn" class="btn btn-warning">Modifier Transaction</button>
                        <button id="delete-transaction-btn" class="btn btn-danger">Supprimer Transaction</button>
                    </div>
                    <div id="user-transaction-totals" class="mt-3"></div>
                </div>
                
                <div class="card">
                    <h3><i class="fas fa-chart-bar"></i> Rapports et Statistiques</h3>
                    <div class="d-flex" style="gap:15px; margin-bottom:15px;">
                        <select id="report-type" class="form-control">
                            <option value="">Sélectionner un type</option>
                            <option value="financial">Financier</option>
                            <option value="transactions">Transactions</option>
                            <option value="patients">Patients</option>
                            <option value="services">Services</option>
                        </select>
                        <input type="date" id="report-start-date" class="form-control" placeholder="Date début">
                        <input type="date" id="report-end-date" class="form-control" placeholder="Date fin">
                        <button id="generate-report-btn" class="btn btn-success">Générer Rapport</button>
                        <button id="export-report-csv" class="btn btn-info">Exporter CSV</button>
                    </div>
                    <div class="mt-3">
                        <button id="generate-user-report-btn" class="btn btn-warning">Rapport Utilisateurs</button>
                        <button onclick="printReport()" class="btn btn-secondary">Imprimer Rapport</button>
                    </div>
                </div>
                
                <!-- Nouveau : Paiement des employés -->
                <div class="card">
                    <h3><i class="fas fa-user-tag"></i> Paiement des employés</h3>
                    <div class="d-flex" style="gap:15px; margin-bottom:15px;">
                        <select id="employee-select" class="form-control">
                            <option value="">Choisir un employé</option>
                        </select>
                        <select id="employee-payment-method" class="form-control">
                            <option value="cash">Espèces</option>
                            <option value="moncash">MonCash</option>
                            <option value="natcash">NatCash</option>
                            <option value="card">Carte</option>
                            <option value="external">Externe</option>
                        </select>
                        <input type="number" id="employee-payment-amount" class="form-control" placeholder="Montant">
                        <button id="pay-employee-btn" class="btn btn-success">Payer</button>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr><th>Employé</th><th>Montant</th><th>Date</th><th>Mode</th></tr>
                            </thead>
                            <tbody id="employee-payments-history"></tbody>
                        </table>
                    </div>
                </div>
                
                <div class="stats-chart-container">
                    <div class="chart-card">
                        <h3 class="chart-title"><i class="fas fa-stethoscope"></i> Consultations</h3>
                        <div id="consultations-chart"></div>
                        <div class="text-center mt-2">
                            <p>Total: <span id="admin-consultations-count">0</span> | Montant: <span id="admin-consultations-amount">0 Gdes</span></p>
                        </div>
                    </div>
                    
                    <div class="chart-card">
                        <h3 class="chart-title"><i class="fas fa-flask"></i> Analyses</h3>
                        <div id="analyses-chart"></div>
                        <div class="text-center mt-2">
                            <p>Total: <span id="admin-analyses-count">0</span> | Montant: <span id="admin-analyses-amount">0 Gdes</span></p>
                        </div>
                    </div>
                    
                    <div class="chart-card">
                        <h3 class="chart-title"><i class="fas fa-pills"></i> Médicaments</h3>
                        <div id="medications-chart"></div>
                        <div class="text-center mt-2">
                            <p>Total: <span id="admin-medications-count">0</span> | Montant: <span id="admin-medications-amount">0 Gdes</span></p>
                        </div>
                    </div>
                    
                    <div class="chart-card">
                        <h3 class="chart-title"><i class="fas fa-external-link-alt"></i> Services Externes</h3>
                        <div id="external-chart"></div>
                        <div class="text-center mt-2">
                            <p>Total: <span id="admin-external-count">0</span> | Montant: <span id="admin-external-amount">0 Gdes</span></p>
                        </div>
                    </div>
                </div>
                
                <div class="admin-stats-grid">
                    <div class="admin-stat-card clickable-stat" id="stat-revenue-card">
                        <h3><i class="fas fa-money-bill-wave"></i> Revenus Totaux</h3>
                        <h2 id="admin-total-revenue">0 Gdes</h2>
                        <p>Période: Aujourd'hui</p>
                        <div class="chart-bar-container mt-2">
                            <div class="chart-bar-label">
                                <span>Payés</span>
                                <span id="paid-percentage">0%</span>
                            </div>
                            <div class="chart-bar-bg">
                                <div id="paid-chart-bar" class="chart-bar-fill" style="width:0%"></div>
                            </div>
                        </div>
                        <div class="chart-bar-container">
                            <div class="chart-bar-label">
                                <span>Non payés</span>
                                <span id="unpaid-percentage">0%</span>
                            </div>
                            <div class="chart-bar-bg">
                                <div id="unpaid-chart-bar" class="chart-bar-fill" style="width:0%; background:#dc3545"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="admin-stat-card">
                        <h3><i class="fas fa-chart-pie"></i> Répartition des Services</h3>
                        <div id="services-pie-chart" class="mt-2" style="height:150px; position:relative;">
                            <div style="display:flex; justify-content:center; align-items:center; height:100%;">
                                <div style="width:120px; height:120px; border-radius:50%; background:conic-gradient(#1a6bca 0% 25%, #28a745 25% 50%, #ffc107 50% 75%, #17a2b8 75% 100%);"></div>
                            </div>
                            <div style="position:absolute; top:50%; left:50%; transform:translate(-50%, -50%); text-align:center;">
                                <h4 id="total-services-count">0</h4>
                                <small>Services</small>
                            </div>
                        </div>
                        <div class="mt-2">
                            <div><span class="percentage-badge" style="background:#1a6bca">Consultations</span> <span id="consultations-percentage">0%</span></div>
                            <div><span class="percentage-badge" style="background:#28a745">Analyses</span> <span id="analyses-percentage">0%</span></div>
                            <div><span class="percentage-badge" style="background:#ffc107">Médicaments</span> <span id="medications-percentage">0%</span></div>
                            <div><span class="percentage-badge" style="background:#17a2b8">Externes</span> <span id="external-percentage">0%</span></div>
                        </div>
                    </div>
                </div>
                
                <div class="card mt-3">
                    <h3><i class="fas fa-history"></i> Transactions Récentes</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Date/Heure</th>
                                    <th>Patient</th>
                                    <th>Service</th>
                                    <th>Montant</th>
                                    <th>Méthode</th>
                                    <th>Agent</th>
                                    <th>Statut</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="recent-transactions-list"></tbody>
                        </table>
                    </div>
                </div>
            </section>
            
            <section id="settings" class="content">
                <h2 class="section-title"><i class="fas fa-cog"></i> Paramètres du Système</h2>
                
                <div class="card">
                    <h3><i class="fas fa-hospital"></i> Informations de l'Hôpital</h3>
                    <div class="hospital-info-form">
                        <div class="form-group">
                            <label class="form-label">Nom de l'Hôpital</label>
                            <input type="text" id="hospital-name" class="form-control" value="Hôpital Saint-Luc">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Adresse</label>
                            <input type="text" id="hospital-address" class="form-control" value="Port-au-Prince, Haïti">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Téléphone</label>
                            <input type="text" id="hospital-phone" class="form-control" value="(509) 1234-5678">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Logo de l'Hôpital</label>
                            <div class="logo-upload-container">
                                <input type="file" id="hospital-logo" class="form-control" accept="image/*">
                                <img id="logo-preview" src="" alt="Aperçu du logo" class="logo-preview" style="display:none;">
                            </div>
                            <small class="text-muted">Taille recommandée: 150x150 pixels. Formats: JPG, PNG</small>
                        </div>
                        <button type="button" id="save-hospital-info-btn" class="btn btn-success">Enregistrer</button>
                    </div>
                </div>
                
                <div class="card">
                    <h3><i class="fas fa-pills"></i> Gestion des Médicaments</h3>
                    <div class="d-flex" style="gap:15px; margin-top:15px;">
                        <input type="text" id="new-medication-name-settings" class="form-control" placeholder="Nom du médicament">
                        <input type="number" id="new-medication-price-settings" class="form-control" placeholder="Prix unitaire (Gdes)" min="0">
                        <input type="number" id="new-medication-quantity-settings" class="form-control" placeholder="Quantité initiale" min="0">
                        <input type="number" id="new-medication-alert-settings" class="form-control" placeholder="Seuil d'alerte" min="0">
                        <button type="button" id="add-medication-settings" class="btn btn-success">
                            <i class="fas fa-plus"></i> Ajouter
                        </button>
                    </div>
                    <div class="table-container mt-3">
                        <table>
                            <thead>
                                <tr>
                                    <th>Médicament</th>
                                    <th>Prix</th>
                                    <th>Quantité</th>
                                    <th>Seuil alerte</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="medications-settings-list"></tbody>
                        </table>
                    </div>
                </div>
                
                <div class="card">
                    <h3><i class="fas fa-stethoscope"></i> Types de Consultation</h3>
                    <div id="consultation-types-list"></div>
                    <div class="d-flex" style="gap:15px; margin-top:15px;">
                        <input type="text" id="new-consultation-type-name" class="form-control" placeholder="Nom du type">
                        <input type="number" id="new-consultation-type-price" class="form-control" placeholder="Prix (Gdes)" min="0">
                        <textarea id="new-consultation-type-description" class="form-control" placeholder="Description" rows="1"></textarea>
                        <button type="button" id="add-consultation-type" class="btn btn-success">
                            <i class="fas fa-plus"></i> Ajouter
                        </button>
                    </div>
                </div>
                
                <div class="card">
                    <h3><i class="fas fa-heartbeat"></i> Signes Vitaux</h3>
                    <div id="vitals-types-list"></div>
                    <div class="d-flex" style="gap:15px; margin-top:15px;">
                        <input type="text" id="new-vital-name" class="form-control" placeholder="Nom du signe vital">
                        <input type="text" id="new-vital-unit" class="form-control" placeholder="Unité (ex: °C, bpm)">
                        <input type="number" id="new-vital-min" class="form-control" placeholder="Valeur min">
                        <input type="number" id="new-vital-max" class="form-control" placeholder="Valeur max">
                        <button type="button" id="add-vital-type" class="btn btn-success">
                            <i class="fas fa-plus"></i> Ajouter
                        </button>
                    </div>
                </div>
                
                <div class="card">
                    <h3><i class="fas fa-flask"></i> Analyses de Laboratoire</h3>
                    <div id="lab-analyses-types-list"></div>
                    <div class="d-flex" style="gap:15px; margin-top:15px;">
                        <input type="text" id="new-lab-analysis-name" class="form-control" placeholder="Nom de l'analyse">
                        <input type="number" id="new-lab-analysis-price" class="form-control" placeholder="Prix (Gdes)" min="0">
                        <select id="new-lab-analysis-type" class="form-control">
                            <option value="text">Résultat texte</option>
                            <option value="image">Résultat image</option>
                        </select>
                        <button type="button" id="add-lab-analysis-type" class="btn btn-success">
                            <i class="fas fa-plus"></i> Ajouter
                        </button>
                    </div>
                </div>
                
                <div class="card">
                    <h3><i class="fas fa-external-link-alt"></i> Services Externes</h3>
                    <div id="external-services-types-list"></div>
                    <div class="d-flex" style="gap:15px; margin-top:15px;">
                        <input type="text" id="new-external-service-type-name" class="form-control" placeholder="Nom du service">
                        <input type="number" id="new-external-service-type-price" class="form-control" placeholder="Prix (Gdes)" min="0">
                        <button type="button" id="add-external-service-type" class="btn btn-success">
                            <i class="fas fa-plus"></i> Ajouter
                        </button>
                    </div>
                </div>
                
                <!-- Nouveau : Fournisseurs -->
                <div class="card">
                    <h3><i class="fas fa-truck"></i> Fournisseurs</h3>
                    <div class="d-flex" style="gap:15px; margin-top:15px;">
                        <input type="text" id="new-supplier-name" class="form-control" placeholder="Nom">
                        <select id="new-supplier-type" class="form-control">
                            <option value="cash">Comptant</option>
                            <option value="credit">Crédit</option>
                        </select>
                        <input type="text" id="new-supplier-contact" class="form-control" placeholder="Contact">
                        <button type="button" id="add-supplier" class="btn btn-success">Ajouter</button>
                    </div>
                    <div class="table-container mt-3">
                        <table>
                            <thead>
                                <tr><th>Nom</th><th>Type</th><th>Contact</th><th>Actions</th></tr>
                            </thead>
                            <tbody id="suppliers-list"></tbody>
                        </table>
                    </div>
                </div>
                
                <div class="card">
                    <h3><i class="fas fa-users"></i> Gestion des Utilisateurs</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Nom</th>
                                    <th>Rôle</th>
                                    <th>Identifiant</th>
                                    <th>Actif</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="users-list"></tbody>
                        </table>
                    </div>
                    
                    <div class="mt-3">
                        <h4>Ajouter un utilisateur</h4>
                        <div class="d-flex" style="gap:15px;">
                            <input type="text" id="new-user-name" class="form-control" placeholder="Nom complet">
                            <select id="new-user-role" class="form-control">
                                <option value="">Sélectionner rôle</option>
                                <option value="admin">Administrateur</option>
                                <option value="responsible">Responsable</option>
                                <option value="secretary">Secrétariat</option>
                                <option value="cashier">Caisse</option>
                                <option value="nurse">Infirmier</option>
                                <option value="doctor">Médecin</option>
                                <option value="lab">Laboratoire</option>
                                <option value="pharmacy">Pharmacie</option>
                            </select>
                            <input type="text" id="new-user-username" class="form-control" placeholder="Identifiant">
                            <input type="password" id="new-user-password" class="form-control" placeholder="Mot de passe">
                            <button type="button" id="add-user" class="btn btn-success">Ajouter</button>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>
    
    <div id="print-container"></div>
<!-- État global et authentification en premier -->
<script src="config.js"></script>
<script src="auth.js"></script>

<!-- Modules métier (ordre quelconque, mais après state) -->
<script src="admin.js"></script>
<script src="admin-eded.js"></script>
<script src="settingjs"></script>
<script src="messagijs"></script>
<script src="secretary.js"></script>
<script src="cashier.js"></script>
<script src="pharmacy.js"></script>
<script src="nurse.js"></script>
<script src="doctor.js"></script>
<script src="laboratory.js"></script>
<script src="responsible.js"></script>
<script src="main.js"></script>
</body>
</html>